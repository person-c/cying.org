{{ partial "header.html" . }}

{{ if .Params.show_toc }} {{ .TableOfContents }} {{ end }}

{{ if (and (eq (getenv "HUGO_BLOGDOWN_POST_RELREF") "") (and (and .Params.date (lt (now.AddDate 0 0 ($.Site.Params.holdDays | default -90)) .Date)) (in (string .Content) "<!--# ON_HOLD -->"))) }}
{{ (index (split .Content "<!--# ON_HOLD -->") 0) | safeHTML }}
{{ else }}
{{ .Content }}
{{ end }}

{{ partial "footer.html" . }}

<script>
document.querySelectorAll('pre,table,#TableOfContents, highlight').forEach(node => {
  function fullwidth(el) {
    el.classList.add('fullwidth');
  }
  switch (node.tagName) {
    case 'PRE':
      const el = node.firstElementChild;
      el?.tagName === 'CODE' && el.scrollWidth > el.offsetWidth && fullwidth(el.parentNode);
      break;
    case 'TABLE':
      const p = node.parentElement;
      p && p.offsetWidth < node.offsetWidth && fullwidth(node);
      break;
    default:
      // assume it's #TableOfContents for now
      node.querySelectorAll('a').forEach(a => {
        // if a TOC line is wrapped, make TOC full-width
        !node.classList.contains('fullwidth') && a.getClientRects().length > 1 && fullwidth(node);
      });
  }
});
</script>
